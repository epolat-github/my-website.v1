{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from \"../components/layout\";\nimport fetch from \"isomorphic-unfetch\";\nimport Router from \"next/router\";\nimport Link from \"next/link\";\nimport ReactMarkdown from \"react-markdown\";\nimport { authInstance, checkUser } from \"../src/dbCon\";\nexport var changeUserState = function changeUserState(user) {\n  if (user) {\n    document.querySelectorAll(\".sign-out\").forEach(function (item) {\n      return item.classList.add(\"d-none\");\n    });\n    document.querySelectorAll(\".sign-in\").forEach(function (item) {\n      return item.classList.remove(\"d-none\");\n    });\n  } //if logged out\n  else {\n      document.querySelectorAll(\".sign-out\").forEach(function (item) {\n        return item.classList.remove(\"d-none\");\n      });\n      document.querySelectorAll(\".sign-in\").forEach(function (item) {\n        return item.classList.add(\"d-none\");\n      });\n    }\n};\n\nvar signinModal = function signinModal() {\n  return __jsx(\"div\", {\n    className: \"modal fade\",\n    id: \"signinModal\",\n    tabIndex: \"-1\",\n    role: \"dialog\",\n    \"aria-labelledby\": \"signinModalLabel\",\n    \"aria-hidden\": \"true\"\n  }, __jsx(\"div\", {\n    className: \"modal-dialog\",\n    role: \"document\"\n  }, __jsx(\"div\", {\n    className: \"modal-content\"\n  }, __jsx(\"div\", {\n    className: \"modal-header\"\n  }, __jsx(\"h5\", {\n    className: \"modal-title\",\n    id: \"signinModalLabel\"\n  }, \"Sign In\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\"\n  }, __jsx(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"\\xD7\"))), __jsx(\"div\", {\n    className: \"modal-body\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"email\",\n    id: \"emailSignin\"\n  }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"input\", {\n    type: \"password\",\n    placeholder: \"password\",\n    id: \"passSignin\"\n  }), __jsx(\"p\", {\n    id: \"statusSignin\"\n  })), __jsx(\"div\", {\n    className: \"modal-footer\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary signin-close-button\",\n    \"data-dismiss\": \"modal\"\n  }, \"Close\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\",\n    onClick: function onClick() {\n      document.getElementById(\"statusSignin\").innerHTML = \"Checking credentials...\";\n      authInstance().signInWithEmailAndPassword(document.getElementById(\"emailSignin\").value, document.getElementById(\"passSignin\").value).then(function () {\n        document.getElementById(\"passSignin\").value = \"\";\n        document.getElementById(\"emailSignin\").value = \"\";\n        changeUserState();\n        Router.push(\"/blog\");\n        document.querySelector(\".signin-close-button\").click(); // window.location.reload();\n      })[\"catch\"](function (error) {\n        document.getElementById(\"statusSignin\").innerHTML = error.code;\n        console.log(\"Error code: \", error.code);\n        console.log(\"Error Message: \", error.message);\n      });\n    }\n  }, \"Sign-in\")))));\n};\n\nvar registerModal = function registerModal() {\n  return __jsx(\"div\", {\n    className: \"modal fade\",\n    id: \"registerModal\",\n    tabIndex: \"-1\",\n    role: \"dialog\",\n    \"aria-labelledby\": \"registerModalLabel\",\n    \"aria-hidden\": \"true\"\n  }, __jsx(\"div\", {\n    className: \"modal-dialog\",\n    role: \"document\"\n  }, __jsx(\"div\", {\n    className: \"modal-content\"\n  }, __jsx(\"div\", {\n    className: \"modal-header\"\n  }, __jsx(\"h5\", {\n    className: \"modal-title\",\n    id: \"registerModalLabel\"\n  }, \"Register\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\"\n  }, __jsx(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"\\xD7\"))), __jsx(\"div\", {\n    className: \"modal-body\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"email\",\n    id: \"emailRegister\"\n  }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"input\", {\n    type: \"password\",\n    placeholder: \"password\",\n    id: \"passRegister\"\n  }), __jsx(\"p\", {\n    id: \"statusRegister\",\n    style: {\n      marginTop: \"3%\"\n    }\n  })), __jsx(\"div\", {\n    className: \"modal-footer\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary register-close-button\",\n    \"data-dismiss\": \"modal\"\n  }, \"Close\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\",\n    onClick: function onClick() {\n      authInstance().createUserWithEmailAndPassword(document.getElementById(\"emailRegister\").value, document.getElementById(\"passRegister\").value).then(function () {\n        console.log(\"Registered.\");\n        document.getElementById(\"statusRegister\").innerHTML = \"Registered.\";\n        Router.push(\"/blog\");\n        document.querySelector(\".register-close-button\").click(); // authInstance().signOut();\n        // window.location.reload();\n      })[\"catch\"](function (error) {\n        console.log(error);\n        document.getElementById(\"statusRegister\").innerHTML = error.message;\n      });\n    }\n  }, \"Register\")))));\n};\n\nvar loginBlogButtons = function loginBlogButtons() {\n  return __jsx(\"div\", {\n    className: \"container-fluid mt-2\"\n  }, __jsx(\"div\", {\n    className: \"row d-flex justify-content-end\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-2 col-md-2 col-6 sign-in\"\n  }, __jsx(Link, {\n    href: \"/admin\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-lg\"\n  }, \"Write\"))), __jsx(\"div\", {\n    className: \"col-lg-2 col-md-2 col-6 sign-in\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary btn-lg\",\n    onClick: function onClick() {\n      authInstance().signOut().then(function () {\n        return window.location.reload();\n      })[\"catch\"](function () {\n        return console.log(\"Sign-out problem.\");\n      });\n    }\n  }, \"Sign-out\"))));\n};\n\nvar logoutBlogButtons = function logoutBlogButtons() {\n  return __jsx(\"div\", {\n    className: \"container-fluid mt-2\"\n  }, __jsx(\"div\", {\n    className: \"row d-flex justify-content-end\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-2 col-md-2 col-6 sign-out\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-lg\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#registerModal\"\n  }, \"Register\")), __jsx(\"div\", {\n    className: \"col-lg-2 col-md-2 col-6 sign-out\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-lg\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#signinModal\"\n  }, \"Sign-in\"))));\n};\n\nvar blogButtons = function blogButtons() {\n  if (checkUser()) {\n    // if logged in\n    return loginBlogButtons();\n  } else {\n    return logoutBlogButtons();\n  }\n}; // const blogButtons = () => {\n//   console.log(checkUser());\n//   return (\n//     <div className=\"container-fluid mt-2\">\n//       <div className=\"row d-flex justify-content-end\">\n//         <div className=\"col-lg-2 col-md-2 col-6 sign-out\">\n//           <button\n//             type=\"button\"\n//             className=\"btn btn-primary btn-lg\"\n//             data-toggle=\"modal\"\n//             data-target=\"#registerModal\"\n//           >\n//             Register\n//           </button>\n//         </div>\n//         <div className=\"col-lg-2 col-md-2 col-6 sign-out\">\n//           <button\n//             type=\"button\"\n//             className=\"btn btn-primary btn-lg\"\n//             data-toggle=\"modal\"\n//             data-target=\"#signinModal\"\n//           >\n//             Sign-in\n//           </button>\n//         </div>\n//         <div className=\"col-lg-2 col-md-2 col-6 sign-in\">\n//           <Link href=\"/write\">\n//             <button type=\"button\" className=\"btn btn-primary btn-lg\">\n//               Write\n//             </button>\n//           </Link>\n//         </div>\n//         <div className=\"col-lg-2 col-md-2 col-6 sign-in\">\n//           <button\n//             type=\"button\"\n//             className=\"btn btn-secondary btn-lg\"\n//             onClick={() => {\n//               authInstance()\n//                 .signOut()\n//                 .then(() => window.location.reload())\n//                 .catch(() => console.log(\"Sign-out problem.\"));\n//             }}\n//           >\n//             Sign-out\n//           </button>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// };\n\n\nvar createCards = function createCards(post) {\n  return __jsx(\"div\", {\n    key: post.slug + Math.random(),\n    className: \"col-md-6 col-lg-4 mb-5\"\n  }, __jsx(\"div\", {\n    className: \"card h-100 border-dark rounded text-white bg-dark mb-3\"\n  }, __jsx(\"div\", {\n    className: \"card-body\"\n  }, __jsx(\"div\", {\n    className: \"card-block\"\n  }, __jsx(\"h3\", {\n    className: \"card-title text-capitalize\"\n  }, __jsx(Link, {\n    href: post.slug\n  }, __jsx(\"a\", null, post.title))), post.details && __jsx(ReactMarkdown, {\n    source: post.details.slice(0, 500) + \"...\"\n  }))), __jsx(\"div\", {\n    className: \"card-footer\"\n  }, __jsx(\"small\", {\n    className: \"text-muted\"\n  }, post.date))));\n};\n\nvar Blog = function Blog(_ref) {\n  var posts = _ref.posts,\n      postCount = _ref.postCount,\n      currPage = _ref.currPage;\n  return __jsx(Layout, null, signinModal(), registerModal(), __jsx(\"article\", {\n    id: \"blog-container\",\n    className: \"jsx-1885384937\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1885384937\" + \" \" + \"row ml-5 mr-5 mt-5\"\n  }, posts && posts.map(function (post) {\n    return createCards(post);\n  })), __jsx(\"nav\", {\n    id: \"page-button-container\",\n    className: \"jsx-1885384937\"\n  }, __jsx(\"button\", {\n    disabled: currPage <= 1,\n    onClick: function onClick() {\n      return Router.push(\"/blog?page=\".concat(currPage - 1));\n    },\n    className: \"jsx-1885384937\" + \" \" + \"page-button\"\n  }, \"<<\"), _toConsumableArray(Array(Math.ceil(postCount / 6))).map(function (curr, index) {\n    return __jsx(\"button\", {\n      key: \"button\" + index,\n      onClick: function onClick() {\n        return Router.push(\"/blog?page=\".concat(index + 1));\n      },\n      className: \"jsx-1885384937\" + \" \" + \"page-button\"\n    }, index + 1);\n  }), __jsx(\"button\", {\n    disabled: currPage >= Math.ceil(postCount / 6),\n    onClick: function onClick() {\n      return Router.push(\"/blog?page=\".concat(currPage + 1));\n    },\n    className: \"jsx-1885384937\" + \" \" + \"page-button\"\n  }, \">>\"))), __jsx(_JSXStyle, {\n    id: \"1885384937\"\n  }, [\"#post-list.jsx-1885384937{color:white;border-bottom:2px solid white;border-radius:25%;text-align:center;margin:1% 10%;padding:1% 0;}\", \"a.jsx-1885384937{font-weight:bold;}\", \".card-title.jsx-1885384937{text-transform:capitalize;}\", \"#page-button-container.jsx-1885384937{max-width:600px;margin:0 auto;margin-bottom:2%;-webkit-transform:translateX(25%);-ms-transform:translateX(25%);transform:translateX(25%);}\", \".page-button.jsx-1885384937{background-color:#0083fe;border:1px solid white;border-radius:20%;color:white;padding:10px 16px;margin:0 3px;-webkit-text-decoration:none;text-decoration:none;font-size:25px;}\", \".page-button.jsx-1885384937:hover{background-color:#2e5e8b;}\", \".page-button[disabled].jsx-1885384937{background-color:gray;}\", \"a[disabled].jsx-1885384937{background-color:red;}\", \"@media only screen and (max-width:600px){.row.jsx-1885384937{margin:5% 2% 3% 2% !important;}#page-button-container.jsx-1885384937{width:100%;display:inline-block;margin-left:50%;margin-bottom:10%;-webkit-transform:translateX(-40%);-ms-transform:translateX(-40%);transform:translateX(-40%);}}\"]));\n};\n\nBlog.getInitialProps = function _callee(_ref2) {\n  var _ref2$query$page, page, res, data;\n\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref2$query$page = _ref2.query.page, page = _ref2$query$page === void 0 ? 1 : _ref2$query$page;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(fetch(\"\".concat(process.env.baseUrl, \"api/posts?page=\").concat(page)));\n\n        case 3:\n          res = _context.sent;\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(res.json());\n\n        case 6:\n          data = _context.sent;\n          return _context.abrupt(\"return\", {\n            posts: data.posts,\n            postCount: _parseInt(data.postCount, 10),\n            currPage: _parseInt(page, 10)\n          });\n\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default Blog;","map":null,"metadata":{},"sourceType":"module"}